let VPN = dynamic([ "NordVPN","ExpressVPN","Proton VPN","Norton VPN","totalvpn","PureVPN","Surfshark","hide.me",
"privatevpn","CyberGhost VPN","piavpn","ipvanish","hotspot shield","Urban VPN","bitdefendervpn","ivacyvpn","Hola VPN",
"Astar VPN","OVPN","SetupVPN","PureVPN","VPN Surf","FoxyProxy","Troywell VPN","Turbo VPN","Planet VPN","KeepSolid VPN",
"Browsec VPN","TunnelBear VPN","1clickvpn","Squid VPN","Hoxx VPN","VeePN","Avast SecureLine VPN","RusVPN","Mozilla VPN",
"TorGuard VPN"
]);
union DeviceProcessEvents,DeviceNetworkEvents 
| where tolower(FileName) has_any (VPN) or tolower(ProcessCommandLine) has_any (VPN) or tolower(FolderPath) 
has_any (VPN) or RemoteUrl has_any (VPN)
| project Timestamp, DeviceName, AccountName, FileName, ProcessCommandLine, SHA1, FolderPath, RemoteUrl, ReportId, ActionType,
InitiatingProcessFileName, InitiatingProcessCommandLine, InitiatingProcessVersionInfoCompanyName,
InitiatingProcessFolderPath, InitiatingProcessSHA1, InitiatingProcessParentFileName
